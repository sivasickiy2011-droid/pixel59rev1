# –≠—Ç–∞–ø 1: –£–ª—É—á—à–µ–Ω–∏–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ RSS

**–§–∞–π–ª –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:** `backend/news-admin/index.py`  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** –°—Ä–µ–¥–Ω—è—è  
**–ü—Ä–∏–º–µ—Ä–Ω—ã–π –æ–±—ä–µ–º:** ~150 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

---

## üéØ –¶–µ–ª—å —ç—Ç–∞–ø–∞

–£–ª—É—á—à–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `fetch_and_translate_news()` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–∑ RSS-–ª–µ–Ω—Ç, –∏—Å–ø–æ–ª—å–∑—É—è –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è feedparser.

---

## üìã –ó–∞–¥–∞—á–∏

1. ‚úÖ –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é `extract_full_content(entry)` –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Ç–µ–∫—Å—Ç–∞ –≤ RSS-–∑–∞–ø–∏—Å–∏
3. ‚úÖ –û–±—ä–µ–¥–∏–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª–µ–π
4. ‚úÖ –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç –∏–∑–≤–ª–µ–∫–∞–µ–º–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –¥–æ 5000 —Å–∏–º–≤–æ–ª–æ–≤
5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üîß –ü—Ä–æ–º–ø—Ç –¥–ª—è –ò–ò –∞–≥–µ–Ω—Ç–∞

```
–ö–û–ù–¢–ï–ö–°–¢:
–¢—ã —Ä–∞–±–æ—Ç–∞–µ—à—å —Å Python-–ø—Ä–æ–µ–∫—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø–∞—Ä—Å–∏—Ç RSS-–ª–µ–Ω—Ç—ã –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –∏—Ö —á–µ—Ä–µ–∑ Ollama (llama3.2).
–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞: –ø–æ–ª—è original_content –∏ translated_content –≤ –ë–î –ø—É—Å—Ç—ã–µ, —Ö–æ—Ç—è –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –≤—ã–¥–µ—Ä–∂–∫–∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è.

–§–ê–ô–õ: backend/news-admin/index.py

–¢–ï–ö–£–©–ê–Ø –ü–†–û–ë–õ–ï–ú–ê (—Å—Ç—Ä–æ–∫–∏ 243-251):
```python
original_content_raw = entry.summary if hasattr(entry, 'summary') else ''
original_content = clean_html(original_content_raw)
content_to_translate = original_content[:2000]
translated_content_raw = translate_full_content(content_to_translate)
translated_content = clean_html(translated_content_raw)
```

–ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ entry.summary, –∫–æ—Ç–æ—Ä—ã–π —á–∞—Å—Ç–æ –ø—É—Å—Ç–æ–π –∏–ª–∏ –æ—á–µ–Ω—å –∫–æ—Ä–æ—Ç–∫–∏–π –≤ RSS-–ª–µ–Ω—Ç–∞—Ö.

–ó–ê–î–ê–ù–ò–ï:

1. –°–æ–∑–¥–∞–π –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é extract_full_content(entry) –ü–ï–†–ï–î —Ñ—É–Ω–∫—Ü–∏–µ–π fetch_and_translate_news():

```python
def extract_full_content(entry) -> str:
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ RSS-–∑–∞–ø–∏—Å–∏.
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è –∏ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –∏—Ö.
    """
    content_parts = []
    
    # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º entry.content (—Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –ø–æ–ª–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º)
    if hasattr(entry, 'content') and entry.content:
        for content_item in entry.content:
            if isinstance(content_item, dict) and 'value' in content_item:
                content_parts.append(content_item['value'])
    
    # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º entry.summary (–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ)
    if hasattr(entry, 'summary') and entry.summary:
        # –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—â–µ –Ω–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏–ª–∏ summary –¥–ª–∏–Ω–Ω–µ–µ
        if not content_parts or len(entry.summary) > len(content_parts[0]):
            if entry.summary not in content_parts:
                content_parts.append(entry.summary)
    
    # 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º entry.description (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ)
    if hasattr(entry, 'description') and entry.description:
        if entry.description not in content_parts:
            content_parts.append(entry.description)
    
    # 4. –ü—Ä–æ–≤–µ—Ä—è–µ–º entry.summary_detail
    if hasattr(entry, 'summary_detail') and entry.summary_detail:
        if isinstance(entry.summary_detail, dict) and 'value' in entry.summary_detail:
            detail_value = entry.summary_detail['value']
            if detail_value not in content_parts:
                content_parts.append(detail_value)
    
    # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ —á–∞—Å—Ç–∏
    full_content = ' '.join(content_parts)
    
    # –õ–æ–≥–∏—Ä—É–µ–º –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    print(f"Extracted content length: {len(full_content)} chars from {len(content_parts)} sources")
    
    return full_content if full_content else ''
```

2. –ó–∞–º–µ–Ω–∏ —Å—Ç—Ä–æ–∫–∏ 243-251 –≤ —Ñ—É–Ω–∫—Ü–∏–∏ fetch_and_translate_news() –Ω–∞:

```python
# –ò–∑–≤–ª–µ–∫–∞–µ–º –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –∏–∑ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
original_content_raw = extract_full_content(entry)
# –û—á–∏—â–∞–µ–º –æ—Ç HTML –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
original_content = clean_html(original_content_raw)

# –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ (—É–≤–µ–ª–∏—á–µ–Ω–æ –¥–æ 5000 —Å–∏–º–≤–æ–ª–æ–≤)
content_to_translate = original_content[:5000] if len(original_content) > 5000 else original_content

# –ü–µ—Ä–µ–≤–æ–¥–∏–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç
if len(content_to_translate) > 50:
    translated_content_raw = translate_full_content(content_to_translate)
    translated_content = clean_html(translated_content_raw)
else:
    # –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –º–∞–ª–æ, –∏—Å–ø–æ–ª—å–∑—É–µ–º excerpt
    translated_content = excerpt_ru
    original_content = clean_summary

print(f'Original content length: {len(original_content)} chars')
print(f'Translated content length: {len(translated_content)} chars')
```

3. –û–±–Ω–æ–≤–∏ —Ñ—É–Ω–∫—Ü–∏—é translate_full_content() (—Å—Ç—Ä–æ–∫–∏ 168-173):

```python
def translate_full_content(text: str) -> str:
    """–ü–µ—Ä–µ–≤–æ–¥ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—É–≤–µ–ª–∏—á–µ–Ω –ª–∏–º–∏—Ç –¥–æ 5000 —Å–∏–º–≤–æ–ª–æ–≤)"""
    if not text or len(text.strip()) < 10:
        return text
    # –£–≤–µ–ª–∏—á–µ–Ω –ª–∏–º–∏—Ç —Å 2000 –¥–æ 5000 —Å–∏–º–≤–æ–ª–æ–≤
    truncated = text[:5000]
    return translate_text(truncated)
```

4. –î–æ–±–∞–≤—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –Ω–∞—á–∞–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏ fetch_and_translate_news() (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 200):

```python
all_news = []

print(f"Starting to fetch news from {len(feeds)} feeds...")

for feed_info in feeds:
```

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –°–æ—Ö—Ä–∞–Ω–∏ –≤—Å—é —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –ª–æ–≥–∏–∫—É –∏ —Ñ—É–Ω–∫—Ü–∏–∏
- –ù–µ –º–µ–Ω—è–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ë–î
- –ù–µ –º–µ–Ω—è–π —Ñ—É–Ω–∫—Ü–∏–∏ clean_html() –∏ translate_text()
- –î–æ–±–∞–≤—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ –∫–æ–¥ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å Python 3.8+

–û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢:
–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –Ω–æ–≤–æ—Å—Ç–µ–π –¥–æ–ª–∂–Ω—ã –∑–∞–ø–æ–ª–Ω—è—Ç—å—Å—è –ø–æ–ª—è original_content –∏ translated_content —Å —Ç–µ–∫—Å—Ç–æ–º –¥–ª–∏–Ω–æ–π > 500 —Å–∏–º–≤–æ–ª–æ–≤.

–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:
–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π —Ñ—É–Ω–∫—Ü–∏—é, –≤—ã–∑–≤–∞–≤ —ç–Ω–¥–ø–æ–∏–Ω—Ç POST /api/news-admin —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (–∫–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å –ª–µ–Ω—Ç—É").
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

1. –§—É–Ω–∫—Ü–∏—è `extract_full_content()` —Å–æ–∑–¥–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. –ö–æ–Ω—Ç–µ–Ω—Ç –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏–∑ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–ª–µ–π RSS
3. –õ–∏–º–∏—Ç —É–≤–µ–ª–∏—á–µ–Ω –¥–æ 5000 —Å–∏–º–≤–æ–ª–æ–≤
4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–ª–∏–Ω—É –∏–∑–≤–ª–µ—á–µ–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
5. –ü–æ–ª—è `original_content` –∏ `translated_content` –≤ –ë–î –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Ollama –∑–∞–ø—É—â–µ–Ω–∞
curl http://localhost:11434/api/tags

# –í—ã–∑–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ API
curl -X POST http://localhost:8000/api/news-admin \
  -H "Authorization: Bearer YOUR_ADMIN_TOKEN" \
  -H "Content-Type: application/json"
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ë–î
```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–ª–∏–Ω—É –∫–æ–Ω—Ç–µ–Ω—Ç–∞
SELECT 
    id, 
    original_title,
    LENGTH(original_content) as orig_len,
    LENGTH(translated_content) as trans_len
FROM news 
ORDER BY created_at DESC 
LIMIT 5;

-- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è > 500
```

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ë—ã–ª–æ:**
- `original_content`: "" (0 —Å–∏–º–≤–æ–ª–æ–≤)
- `translated_content`: "" (0 —Å–∏–º–≤–æ–ª–æ–≤)

**–°—Ç–∞–Ω–µ—Ç:**
- `original_content`: "Full article text..." (500-5000 —Å–∏–º–≤–æ–ª–æ–≤)
- `translated_content`: "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—å–∏..." (500-5000 —Å–∏–º–≤–æ–ª–æ–≤)

---

## ‚è≠Ô∏è –°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞ 1 –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ **–≠—Ç–∞–ø—É 2: Web scraping** –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü —Å—Ç–∞—Ç–µ–π (–¥–ª—è —Å–ª—É—á–∞–µ–≤, –∫–æ–≥–¥–∞ RSS –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞).

---

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ—Ç —ç—Ç–∞–ø —Ä–µ—à–∞–µ—Ç ~60% –ø—Ä–æ–±–ª–µ–º—ã. –î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è —ç—Ç–∞–ø—ã 2-3.
